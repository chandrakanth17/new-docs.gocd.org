<!DOCTYPE html>

<html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running out of Disk Space | GoCD User Documentation</title>

<link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono:300,400,700" rel="stylesheet">
<link rel="stylesheet" href="../normalize.min.css">

<link rel="stylesheet" href="../book.min.29d743ffb6d61ecbfc9bb21b7eab17d63b577d4bd547c3f095addb1c793ab1b1.css">
  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">



    <ul>
<li><a href="../"><strong>Introduction</strong></a></li>
<li><a href="../navigation.html"><strong>GoCD Tour</strong></a>

<ul>
<li><a href="../navigation/pipelines_dashboard_page.html">Pipeline Dashboard</a></li>
<li><a href="../navigation/agents_page.html">Agents</a></li>
<li><a href="../navigation/agent_details.html">Agent Details</a></li>
<li><a href="../navigation/pipeline_activity_page.html">Pipeline Activity</a></li>
<li><a href="../navigation/stage_details_page.html">Stage Details</a></li>
<li><a href="../navigation/job_details_page.html">Job Details</a></li>
<li><a href="../navigation/administration_page.html">Administration</a></li>
<li><a href="../navigation/server_details_page.html">Server Details</a></li>
<li><a href="../navigation/environments_page.html">Environments</a></li>
<li><a href="../navigation/value_stream_map.html">Value Stream Map</a></li>
</ul></li>
<li><a href="../configuration.html"><strong>Configuration</strong></a>

<ul>
<li><a href="../configuration/quick_pipeline_setup.html">Setup a New Pipeline</a></li>
<li><a href="../configuration/managing_pipelines.html">Managing Pipelines</a></li>
<li><a href="../configuration/managing_dependencies.html">Managing Dependencies</a></li>
<li><a href="../configuration/managing_a_build_cloud.html">Managing Agents</a></li>
<li><a href="../configuration/managing_environments.html">Managing Environments</a></li>
<li><a href="../configuration/build_labelling.html">Pipeline Labelling</a></li>
<li><a href="../configuration/pipeline_scheduling.html">Pipeline Scheduling</a></li>
<li><a href="../configuration/admin_use_parameters_in_configuration.html">Parameterize a Pipeline</a></li>
<li><a href="../configuration/admin_use_custom_pipeline_label.html">Customize a Pipeline Label</a></li>
<li><a href="../configuration/admin_clone_pipeline.html">Clone a Pipeline</a></li>
<li><a href="../configuration/admin_lock_pipelines.html">Lock a Pipeline</a></li>
<li><a href="../configuration/admin_add_material.html">Add Material to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_stage.html">Add Stage to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_job.html">Add job to Existing Stage</a></li>
<li><a href="../configuration/admin_add_task.html">Add task to Existing Job</a></li>
<li><a href="../configuration/pipeline_templates.html">Pipeline Templates</a></li>
<li><a href="../configuration/elastic_agents.html">Elastic Agents</a></li>
<li><a href="../configuration/dev_choose_when_stage_runs.html">Choose When a Stage Runs</a></li>
<li><a href="../configuration/admin_timer.html">Timer Trigger</a></li>
<li><a href="../configuration/job_timeout.html">Job Timeout</a></li>
<li><a href="../configuration/managing_users.html">Managing Users</a></li>
<li><a href="../configuration/dev_authentication.html">Authentication</a></li>
<li><a href="../configuration/dev_authorization.html">Authorizing Users</a></li>
<li><a href="../configuration/delegating_group_administration.html">Delegating Group Administration</a></li>
<li><a href="../configuration/pipeline_group_admin_config.html">Pipeline Group Administration</a></li>
<li><a href="../configuration/dev_upload_test_report.html">Publish Reports and Artifacts</a></li>
<li><a href="../configuration/managing_artifacts_and_reports.html">Managing Artifacts and Reports</a></li>
<li><a href="../configuration/delete_artifacts.html">Auto Delete Artifacts</a></li>
<li><a href="../configuration/ui_testing.html">UI Testing</a></li>
<li><a href="../configuration/admin_mailhost_info.html">Mailhost Information</a></li>
<li><a href="../configuration/dev_notifications.html">Notifications</a></li>
<li><a href="../configuration/tfs_config.html">TFS Material configuration</a></li>
<li><a href="../configuration/configuration_reference.html">Reference</a></li>
<li><a href="../configuration/schema.html">Schema</a></li>
</ul></li>
<li><a href="../faq.html"><strong>FAQ/Troubleshooting</strong></a>

<ul>
<li><a href="../faq/ordering_of_pipelines.html">Ordering of Pipelines</a></li>
<li><a href="../faq/stage_old_config.html">Historical Configuration</a></li>
<li><a href="../faq/concurrent_config_modifications.html">Concurrent Modifications to Config</a></li>
<li><a href="../faq/dev_understand_why_build_broken.html">Why the Build is Broken?</a></li>
<li><a href="../faq/dev_see_artifact_as_tab.html">See artifacts as sub-tabs</a></li>
<li><a href="../faq/dev_save_properties.html">Save Properties for a Build</a></li>
<li><a href="../faq/environment_variables.html">Using Environment variables</a></li>
<li><a href="../faq/rm_deploy_to_environment.html">Deploy to an environment</a></li>
<li><a href="../faq/tester_what_has_changed.html">See changes in new binary</a></li>
<li><a href="../faq/dependency_management.html">Run Tests against new Builds</a></li>
<li><a href="../faq/rm_what_is_deployed.html">Check What&rsquo;s Deployed</a></li>
<li><a href="../faq/deploy_a_specific_build_to_an_environment.html">Deploy a Specific Build</a></li>
<li><a href="../faq/agent_guid_issue.html">Clone/Copy an Existing Agents</a></li>
<li><a href="../faq/job_rerun.html">How do I re-run jobs?</a></li>
<li><a href="../faq/material_update_hung.html">Go unable to poll for changes</a></li>
<li><a href="../faq/artifact_integrity.html">Artifact integrity verification</a></li>
<li><a href="../faq/notifications_page.html">Email Notifications</a></li>
<li><a href="../faq/admin_out_of_disk_space.html">Running out of Disk Space</a></li>
<li><a href="../faq/docker_container_ssh_keys.html">Configure SSH Keys for dockerized GoCD</a></li>
</ul></li>
</ul>




</nav>
    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="../svg/menu.svg" />
  </label>
  <strong>Running out of Disk Space</strong>
</header>

      
<article class="markdown">

<h1 id="running-out-of-disk-space">Running out of disk space</h1>

<p>After you&rsquo;ve had GoCD running for a while, you may notice the following warning box when browsing GoCD:</p>

<p><img src="../images/1_low_disk_space_on_artifacts.png" alt="" /></p>

<p>If you don&rsquo;t do anything about it, you&rsquo;ll end up seeing the following error:</p>

<p><img src="../images/2_out_of_disk_space_on_artifacts.png" alt="" /></p>

<p>GoCD will stop scheduling new pipelines until you make more room, either by compressing large files, attaching a larger hard drive, or by deleting unused artifacts. You could also let GoCD manage artifact disk space by enabling auto purge of old artifacts.</p>

<h2 id="auto-delete-artifacts">Auto delete artifacts</h2>

<h3 id="introduction">Introduction</h3>

<p>GoCD can be configured to automatically delete artifacts if the available disk space on the server is low. GoCD will purge artifacts when available disk space is lower than the given value. Artifacts will be purged upto the point when available disk space is greater than a defined value.</p>

<h3 id="configuration">Configuration</h3>

<h4 id="specify-artifact-purge-start-and-end-limits">Specify artifact purge start and end limits</h4>

<blockquote>
<p>You must be logged in as an admin user to configure this step.</p>
</blockquote>

<ol>
<li>Navigate to the Admin section on the GoCD dashboard.</li>
<li>Navigate to the Pipeline Management sub-section</li>
<li>Specify when GoCD should begin to purge artifacts in the first edit box.</li>
<li>Specify when GoCD should stop purging artifacts in the second edit box.</li>
</ol>

<p><img src="../images/pipeline_management.png" alt="Purge artifacts" /></p>

<h4 id="never-delete-artifacts-for-a-stage">Never delete artifacts for a stage</h4>

<blockquote>
<p>You must be logged in as an admin user to configure this step.</p>
</blockquote>

<p>You can disallow deletion of artifacts from a particular stage so that those artifacts are excluded during deletion. This option can be set in the stage editor for a pipeline. This option can be set for stages that are important so that artifacts for the stage are preserved.</p>

<ol>
<li>Navigate to the admin section on the GoCD dashboard.</li>
<li>Navigate to the pipelines section and choose a pipeline to edit</li>
<li>Navigate to the stage settings for the stage</li>
</ol>

<p><img src="../images/artifact_disable_stage.png" alt="Disable artifact cleanup" /></p>

<p>4.Check the box &lsquo;Never Cleanup Artifacts&rsquo;</p>

<h3 id="also-see">Also see&hellip;</h3>

<ul>
<li><a href="../configuration/managing_artifacts_and_reports.html">Managing artifacts and reports</a></li>
<li><a href="../advanced_usage/dev_clean_up_when_cancel.html">Clean up after cancelling a task</a></li>
</ul>

<h2 id="compress-large-log-files">Compress large log files</h2>

<p>In many cases, the easiest thing to do is compress some of the larger artifacts that you won&rsquo;t frequently have need for. For example, if you have a large log file named &lsquo;test.log&rsquo; and you&rsquo;re running GoCD server on a unix machine, the following script will gzip those files that haven&rsquo;t been modified in the last 10 days</p>

<pre><code>find /var/lib/go-server/logs/pipelines -name test.log -mtime +10 -type f -exec gzip -v '{}' \;
</code></pre>

<p>Now, if you add this to a system <a href="http://en.wikipedia.org/wiki/Cron">crontab</a>, your server can compress large artifacts automatically.</p>

<h2 id="move-the-artifact-repository-to-a-new-larger-drive">Move the artifact repository to a new (larger) drive</h2>

<p>If compressing large artifacts is not giving you enough free space, another thing you can do is attach a larger disk drive to store artifacts. After the drive is attached to the system, we can easily change the location GoCD uses for it&rsquo;s artifact repository.</p>

<ul>
<li>Find the location of the GoCD configuration file</li>
<li>Navigate to the <a href="../navigation/administration_page.html">Admin</a> section
<img src="../images/topnav_admin.png" alt="" /></li>
<li>Click on the &ldquo;Config XML&rdquo; tab</li>
<li>The location of the configuration file is listed here
<img src="../images/4_find_config_location.png" alt="" /></li>
<li>Install the new drive</li>
<li>Shut down GoCD server</li>
<li>Copy all files from the original artifact repository location to the new drive</li>
<li>Change the artifact repository location in the configuration file
<code>
&lt;server artifactsDir=&quot;/path/to/new/artifacts&quot;&gt;
...
&lt;/server&gt;
</code></li>
<li>Start up GoCD server and verify you still have access to old artifacts</li>
</ul>

<h2 id="delete-unused-artifacts">Delete unused artifacts</h2>

<p>Another option for making more room is to remove unused (or easily recreatable) artifacts. You may also have old pipelines that you no longer need.</p>

<p>The directory structure of the artifact repository makes selecting which artifacts are safe to delete easier. The format is:</p>

<pre><code>[artifacts-dir]/pipelines/[pipelineName]/[pipelineLabel]/[stageName]/[stageCounter]/[jobName]
</code></pre>

<blockquote>
<p>Keep in mind that there are two files that GoCD needs in order to display the <a href="../navigation/job_details_page.html">Job</a> or <a href="../navigation/stage_details_page.html">Stage</a> details pages</p>

<ul>
<li>cruise-output/console.log</li>
<li>cruise-output/log.xml</li>
</ul>
</blockquote>
</article>

      

    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#running-out-of-disk-space">Running out of disk space</a>
<ul>
<li><a href="#auto-delete-artifacts">Auto delete artifacts</a>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#specify-artifact-purge-start-and-end-limits">Specify artifact purge start and end limits</a></li>
<li><a href="#never-delete-artifacts-for-a-stage">Never delete artifacts for a stage</a></li>
</ul></li>
<li><a href="#also-see">Also see&hellip;</a></li>
</ul></li>
<li><a href="#compress-large-log-files">Compress large log files</a></li>
<li><a href="#move-the-artifact-repository-to-a-new-larger-drive">Move the artifact repository to a new (larger) drive</a></li>
<li><a href="#delete-unused-artifacts">Delete unused artifacts</a></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
